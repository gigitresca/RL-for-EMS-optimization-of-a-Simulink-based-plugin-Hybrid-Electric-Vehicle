clc
clear all
close all
load ADD_Workspace_MercedesE_RL_noEngineTimer.mat

bmep_max_hot_index = [0 11.7	17.1 24.5 25.2 25.2 25.4 25.4 25.3 25.7	25.6 25.4 25.5 25.5	25.4 25.2 24.8 24.3	23.0 22.7 22.3 21.2	16.8 11.6];
plot(eng.init.spd_max_hot_index,bmep_max_hot_index)

bmep_fuel_index = [-2.34 -2.27 -2.02 -1.75 -1.72 -1.63 -1.46 -1.37 -1.29 -1.27 -1.26 -0.97 -0.88 -0.8 -0.77 -0.72 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0];
spd_fuel_index = [500.0	750.0	1000.0	1250.0	1500.0	1750.0	2000.0	2250.0	2500.0	2750.0	3000.0	3250.0	3500.0	3750.0	4000.0	4250.0	4500.0	4750.0	5000.0]*pi/30;
FUEL_MAP = [0.0	0.0	0.0	0.0	0.0	0.0	0.0	0.0	0.0	0.0	0.0	0.0	0.0	0.0	0.0	0.0	0.0	0.0	0.0
                            0.0	0.0	0.0	0.0	0.0	0.0	0.0	0.0	0.0	0.0	0.0	0.0	0.0	0.0	0.0	0.0	0.0	0.0	5.9
                            0.0	0.0	0.0	0.0	0.0	0.0	0.0	0.0	0.0	0.0	0.0	0.0	0.0	0.0	0.0	0.0	4.2	5.1	5.9
                            0.0	0.0	0.0	0.0	0.0	0.0	0.0	0.0	0.0	0.0	0.0	0.0	0.0	0.0	2.9	3.6	4.2	5.1	5.9
                            0.0	0.0	0.0	0.0	0.0	0.0	0.0	0.0	0.0	0.0	0.0	0.0	2.3	2.6	2.9	3.6	4.2	5.1	5.9
                            0.0	0.0	0.0	0.0	0.0	0.0	0.0	0.0	0.0	0.0	0.0	2.1	2.3	2.6	2.9	3.6	4.2	5.1	5.9
                            0.0	0.0	0.0	0.0	0.0	0.0	0.0	0.0	0.0	0.0	1.8	2.1	2.3	2.6	2.9	3.6	4.2	5.1	5.9
                            0.0	0.0	0.0	0.0	0.0	0.0	0.0	0.0	0.0	1.6	1.8	2.1	2.3	2.6	2.9	3.6	4.2	5.1	5.9
                            0.0	0.0	0.0	0.0	0.0	0.0	1.1	0.0	0.0	1.6	1.8	2.1	2.3	2.6	2.9	3.6	4.2	5.1	5.9
                            0.0	0.0	0.0	0.0	0.0	0.0	1.1	0.0	1.4	1.6	1.8	2.1	2.3	2.6	2.9	3.6	4.2	5.1	5.9
                            0.0	0.0	0.0	0.0	0.0	1.0	1.1	0.0	1.4	1.6	1.8	2.1	2.3	2.6	2.9	3.6	4.2	5.1	5.9
                            0.0	0.0	0.0	0.0	0.0	1.0	1.1	1.1	1.4	1.6	1.8	2.1	2.3	2.6	2.9	3.6	4.2	5.1	5.9
                            0.0	0.0	0.0	0.0	0.7	1.0	1.1	1.1	1.4	1.6	1.8	2.1	2.3	2.6	2.9	3.6	4.2	5.1	5.9
                            0.0	0.0	0.0	0.5	0.7	1.0	1.1	1.1	1.4	1.6	1.8	2.1	2.3	2.6	2.9	3.6	4.2	5.1	5.9
                            0.0	0.0	0.4	0.5	0.7	1.0	1.1	1.1	1.4	1.6	1.8	2.1	2.3	2.6	2.9	3.6	4.2	5.1	5.9
                            0.0	0.3	0.4	0.5	0.7	1.0	1.1	1.1	1.4	1.6	1.8	2.1	2.3	2.6	2.9	3.6	4.2	5.1	5.9
                            0.3	0.3	0.4	0.5	0.7	1.0	1.1	1.1	1.4	1.6	1.8	2.1	2.3	2.6	2.9	3.6	4.2	5.1	5.9
                            0.4	0.5	0.6	0.8	1.0	1.2	1.5	1.7	1.9	2.3	2.6	2.9	3.2	3.6	4.2	4.8	5.5	6.1	6.7
                            0.6	0.7	0.9	1.2	1.4	1.7	2.0	2.3	2.6	3.0	3.4	3.8	4.2	4.7	5.4	6.2	6.9	7.3	7.6
                            0.8	1.0	1.2	1.5	1.8	2.2	2.6	3.0	3.3	3.8	4.3	4.7	5.2	5.9	6.6	7.5	8.3	8.5	8.7
                            1.0	1.2	1.5	1.9	2.3	2.7	3.2	3.6	4.1	4.6	5.2	5.7	6.3	7.0	7.8	8.6	9.2	9.6	9.7
                            1.2	1.5	1.9	2.3	2.8	3.2	3.7	4.3	4.8	5.4	6.1	6.7	7.3	8.2	9.1	9.7	10.2	10.6	10.8
                            1.4	1.7	2.2	2.7	3.2	3.8	4.4	5.0	5.6	6.3	7.0	7.6	8.4	9.4	10.3	10.9	11.4	11.7	11.9
                            1.7	2.0	2.6	3.1	3.7	4.4	5.0	5.7	6.4	7.1	7.9	8.6	9.5	10.6	11.6	12.2	12.6	12.9	13.1
                            1.9	2.3	2.9	3.6	4.3	4.9	5.7	6.4	7.2	8.0	8.8	9.7	10.6	11.8	12.9	13.5	13.9	14.1	14.3
                            2.3	2.6	3.4	4.1	4.8	5.6	6.3	7.2	8.0	8.9	9.8	10.7	11.7	13.0	14.3	14.9	15.2	15.4	15.6
                            2.8	3.2	3.8	4.6	5.4	6.2	7.0	7.9	8.8	9.7	10.7	11.7	12.8	14.3	15.6	16.3	16.6	16.8	16.9
                            3.4	3.7	4.2	5.1	5.9	6.7	7.7	8.5	9.5	10.6	11.6	12.7	13.9	15.6	17.0	17.7	18.0	18.2	18.3
                            4.0	4.3	4.7	5.6	6.4	7.3	8.3	9.2	10.3	11.4	12.6	13.8	15.1	16.8	18.4	19.0	19.4	19.6	19.7
                            4.7	4.9	5.2	6.0	6.9	7.9	8.9	10.0	11.1	12.3	13.5	14.8	16.3	18.0	19.5	20.4	20.8	21.0	21.1
                            5.4	5.6	6.0	6.6	7.5	8.4	9.5	10.7	11.9	13.2	14.5	15.9	17.4	19.3	20.9	21.8	22.2	22.4	22.6
                            6.1	6.3	6.7	7.2	8.1	9.0	10.2	11.4	12.7	14.0	15.4	16.9	18.6	20.6	22.3	23.2	23.6	23.9	24.0
                            6.7	6.9	7.2	7.7	8.6	9.6	10.9	12.1	13.5	14.9	16.4	18.0	19.7	22.0	24.0	24.7	25.1	25.3	25.5
                            7.4	7.5	7.8	8.3	9.1	10.2	11.5	12.9	14.3	15.8	17.4	19.1	21.0	23.2	25.1	26.1	26.6	26.8	26.9
                            8.0	8.1	8.3	8.7	9.7	10.7	12.2	13.6	15.1	16.7	18.3	20.2	22.2	24.5	26.6	27.6	28.0	28.2	28.2
                            8.6	8.7	8.9	9.3	10.2	11.4	12.9	14.4	15.9	17.6	19.3	21.3	23.4	25.9	28.0	29.1	29.5	29.5	29.5
                            9.1	9.3	9.5	10.0	10.8	11.9	13.6	15.1	16.7	18.5	20.4	22.4	24.5	27.5	30.0	30.9	30.9	30.7	30.5
                            9.6	9.8	10.1	10.5	11.3	12.6	14.2	15.9	17.6	19.5	21.5	23.6	26.1	29.3	32.4	32.5	32.1	31.7	31.4
                            10.1	10.3	10.6	11.0	11.6	13.1	14.9	16.7	18.5	20.5	22.6	25.0	27.4	30.4	32.8	33.1	32.8	32.4	32.1
                            10.5	10.7	11.0	11.4	12.2	13.8	15.6	17.4	19.4	21.4	23.8	26.6	29.4	31.4	32.7	33.1	33.1	32.8	32.6
                            10.8	11.1	11.4	11.9	12.8	14.5	16.3	18.3	20.3	22.4	24.7	28.1	31.4	32.3	32.8	33.1	33.1	33.0	32.9
                            11.1	11.4	11.8	12.4	13.4	15.3	17.1	19.2	21.4	23.7	26.1	29.1	31.7	32.6	32.9	33.1	33.2	33.2	33.1
                            11.3	11.6	12.1	12.9	14.1	15.8	17.7	20.1	22.5	24.9	27.5	29.7	31.4	32.4	32.9	33.1	33.2	33.2	33.2]/3600;

[SPD_FUEL_IDX,BMEP_FUEL_IDX] = meshgrid(spd_fuel_index,bmep_fuel_index);
fuel_max = interp2(SPD_FUEL_IDX,BMEP_FUEL_IDX,FUEL_MAP,eng.init.spd_max_hot_index,bmep_max_hot_index);
figure
plot(eng.init.spd_max_hot_index,fuel_max)
eng.init.fuel_max_hot = fuel_max;

clear bmep_max_hot_index BMEP_FUEL_IDX bmep_fuel_index FUEL_MAP fuel_max SPD_FUEL_IDX spd_fuel_index

% save("ADD_Workspace_MercedesE_RL_noEngineTimer.mat")